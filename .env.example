# Nexus Environment Configuration Example
# Copy to .env and fill in values, or run `make setup` to auto-generate.

# =============================================================================
# Application Config
# =============================================================================

# Environment: local | test | staging | prod
NEXUS_ENV=local

# =============================================================================
# Database URLs (Supabase local Postgres on port 54322)
# =============================================================================

DATABASE_URL=postgresql+psycopg://postgres:postgres@localhost:54322/postgres
DATABASE_URL_TEST=postgresql+psycopg://postgres:postgres@localhost:54322/nexus_test
DATABASE_URL_TEST_MIGRATIONS=postgresql+psycopg://postgres:postgres@localhost:54322/nexus_test_migrations

# =============================================================================
# Redis / Celery
# =============================================================================

REDIS_PORT=6379
REDIS_URL=redis://localhost:6379/0

# Optional: Override Celery URLs (defaults to REDIS_URL)
# CELERY_BROKER_URL=redis://localhost:6379/0
# CELERY_RESULT_BACKEND=redis://localhost:6379/0

# =============================================================================
# Supabase Local Configuration
# Run `supabase status` to get these values after `supabase start`
# =============================================================================

SUPABASE_URL=http://127.0.0.1:54321
SUPABASE_ANON_KEY=<your-anon-key-from-supabase-status>
SUPABASE_SERVICE_ROLE_KEY=<your-service-role-key-from-supabase-status>

# =============================================================================
# Supabase Auth Settings (required in all environments)
# These are used by FastAPI to verify JWT tokens
# =============================================================================

SUPABASE_ISSUER=http://127.0.0.1:54321/auth/v1
SUPABASE_JWKS_URL=http://127.0.0.1:54321/auth/v1/.well-known/jwks.json
SUPABASE_AUDIENCES=authenticated

# =============================================================================
# Internal Secret (required in staging/prod only)
# Used for BFF -> FastAPI authentication
# =============================================================================

# NEXUS_INTERNAL_SECRET=<generate-a-secure-random-string>

# =============================================================================
# Streaming (PR-08) — Direct browser→fastapi SSE
# =============================================================================

# HS256 signing key for stream tokens (base64-encoded, 32+ bytes)
# Required in staging/prod; auto-generated deterministic key in local/test
# STREAM_TOKEN_SIGNING_KEY=<base64-encoded-32-byte-key>

# Public URL browsers use for /stream/* (e.g. https://api.nexus.example.com)
# Defaults to http://localhost:8000 in local/test
# STREAM_BASE_URL=http://localhost:8000

# Comma-separated allowed CORS origins for /stream/* endpoints (no wildcard)
# STREAM_CORS_ORIGINS=http://localhost:3000

# Default max output tokens for budget reservation (default: 1024)
# STREAM_MAX_OUTPUT_TOKENS_DEFAULT=1024
